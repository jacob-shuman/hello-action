name: Test

on: [push, pull_request, workflow_dispatch]

env:
  ACT: $ACT

jobs:
  test-github:
    if: ${{ !$ACT }}
    name: "Test on GitHub"
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: Install Dependencies
        uses: bahmutov/npm-install@v1
        with:
          useLockFile: false

      - name: Build Action
        run: npm run build

      - uses: ./

  test-act:
    if: ${{ $ACT }}
    name: "Test using Nektos Act"
    runs-on: ubuntu-latest
    steps:
      - run: env
      - name: Checkout Repository
        uses: actions/checkout@v2
        with:
          path: "hello-action"

      - name: Install Dependencies
        run: npm i
        working-directory: "hello-action"

      - name: Build Action
        run: npm run build
        working-directory: "hello-action"

      - name: Test Action
        uses: ./
